#!/usr/bin/env ruby

# Setup bundler so we can require gems
ENV['BUNDLE_GEMFILE'] ||= File.expand_path('../Gemfile', __dir__)
ENV['BUNDLE_PATH'] ||= File.expand_path('../.bundle', __dir__)
require 'bundler/setup'

require 'bcf/flightplans'
require 'tmpdir'
require 'open3'

if ARGV.length != 1
  puts "Usage: render-pdf <flightplan>"
  exit 1
end

puts "Rendering PDF for #{ARGV[0]}"

load(ARGV[0])

flight_plan = BCF::FlightPlans::FLIGHT_PLANS.last

if flight_plan.nil?
  puts "No flight plan found in #{ARGV[0]}"
  exit 1
end

flight_plan.render_pdf(File.basename(ARGV[0], '.rb') + '.pdf')
